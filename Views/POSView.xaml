<UserControl x:Class="NexusPOS.Views.POSView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:vm="clr-namespace:NexusPOS.ViewModels"
             mc:Ignorable="d" 
             d:DesignHeight="720" d:DesignWidth="1280"
             FlowDirection="RightToLeft">

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="7*"/>
            <ColumnDefinition Width="3*"/>
        </Grid.ColumnDefinitions>

        <!-- LEFT: DataGrid -->
        <Border Grid.Column="0" Margin="20" Background="{StaticResource SurfaceBrush}" CornerRadius="15" Padding="5">
            <DataGrid ItemsSource="{Binding CartItems}" 
                      AutoGenerateColumns="False" 
                      CanUserAddRows="False"
                      Background="Transparent"
                      BorderThickness="0">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="کالا" Binding="{Binding Product.Name}" Width="*"/>
                    <DataGridTextColumn Header="تعداد" Binding="{Binding Quantity}" Width="Auto"/>
                    <DataGridTextColumn Header="قیمت" Binding="{Binding UnitPrice, StringFormat='{}{0:N0}'}" Width="Auto"/>
                    <DataGridTextColumn Header="جمع" Binding="{Binding TotalPrice, StringFormat='{}{0:N0}'}" Width="Auto"/>
                </DataGrid.Columns>
            </DataGrid>
        </Border>

        <!-- RIGHT: Totals & Actions -->
        <Border Grid.Column="1" Margin="0,20,20,20" Background="{StaticResource SurfaceBrush}" CornerRadius="15">
            <Grid Margin="20">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Totals -->
                <StackPanel Grid.Row="0" VerticalAlignment="Center">
                    <TextBlock Text="مبلغ قابل پرداخت" Foreground="{StaticResource TextSecondaryBrush}" HorizontalAlignment="Center"/>
                    <TextBlock Text="{Binding FinalPayable, StringFormat='{}{0:N0} ریال'}" 
                               FontSize="32" FontWeight="Bold" Foreground="{StaticResource SecondaryBrush}" 
                               HorizontalAlignment="Center" Margin="0,10,0,30"/>
                    
                    <Grid Margin="0,5">
                        <TextBlock Text="جمع کل" Foreground="{StaticResource TextSecondaryBrush}"/>
                        <TextBlock Text="{Binding TotalAmount, StringFormat='{}{0:N0}'}" HorizontalAlignment="Right"/>
                    </Grid>
                    <Grid Margin="0,5">
                        <TextBlock Text="تخفیف" Foreground="{StaticResource TextSecondaryBrush}"/>
                        <TextBlock Text="{Binding Discount, StringFormat='{}{0:N0}'}" HorizontalAlignment="Right" Foreground="Red"/>
                    </Grid>
                </StackPanel>

                <!-- Buttons -->
                <StackPanel Grid.Row="1">
                    <Button Content="افزودن تست" Command="{Binding AddToCartCommand}" Margin="0,0,0,10" Height="40"/>
                    <Button Content="تسویه حساب (F5)" Command="{Binding PayCommand}" Background="Green" Foreground="White" Height="60" FontSize="18" FontWeight="Bold"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</UserControl>
